<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Suivi Musculation â€” 3 SÃ©ances (cibles intÃ©grÃ©es)</title>
<style>
  :root{
    --bg:#0f1115; --card:#151925; --muted:#8b94a7; --text:#e9eef7; --accent:#7cc5ff; --accent2:#9effa1; --danger:#ff6b6b;
    --border:#23283a;
  }
  body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text)}
  .container{max-width:1200px;margin:24px auto;padding:0 16px}
  .grid{display:grid;gap:16px}
  @media(min-width:900px){.grid-2{grid-template-columns:1fr 1fr}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px}
  h1{font-size:24px;margin-bottom:16px}
  label{font-size:12px;color:var(--muted);display:block;margin:6px 0 4px}
  input,select{width:100%;padding:8px;border-radius:8px;border:1px solid var(--border);background:#0f1320;color:var(--text)}
  .exo-grid{display:grid;grid-template-columns:2fr 1fr repeat(3,1fr) 2fr auto;gap:8px;align-items:center;margin:6px 0}
  .btn{padding:6px 12px;border-radius:8px;cursor:pointer}
  .primary{background:var(--accent);border:none}
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{border:1px solid var(--border);padding:6px;font-size:13px}
  th{background:#1a1f2e;color:var(--muted)}
  canvas{width:100%;height:260px;background:#0f1320;margin-top:8px;border-radius:8px}
  .tag{font-size:11px;color:#c9d2ea;background:#0f1320;border:1px solid var(--border);border-radius:999px;padding:3px 8px;display:inline-block;margin-left:6px}
</style>
</head>
<body>
<div class="container">
  <h1>ðŸ“Š Suivi Musculation â€” 3 SÃ©ances (avec cibles sÃ©ries Ã— reps)</h1>
  <div class="grid grid-2">
    <div class="card">
      <label>SÃ©ance :</label>
      <select id="session">
        <option value="A">SÃ©ance A â€” Bas + Push</option>
        <option value="B">SÃ©ance B â€” Dos + Jambes + Biceps</option>
        <option value="C">SÃ©ance C â€” Pecs/Ã‰paules + Jambes + Core</option>
      </select>
      <label>Date :</label><input type="date" id="date">
      <div id="exoList"></div>
      <button class="btn primary" id="saveSessionBtn">ðŸ’¾ Enregistrer la sÃ©ance complÃ¨te</button>
      <button class="btn" id="exportBtn">Exporter</button>
      <input type="file" id="importFile" style="display:none">
      <button class="btn" onclick="document.getElementById('importFile').click()">Importer</button>
      <button class="btn" id="clearBtn">Tout effacer</button>
      <p><span id="count">0</span> enregistrements</p>
    </div>
    <div class="card">
      <label>Filtrer exercice :</label><select id="filterExercise"></select>
      <label>MÃ©trique :</label>
      <select id="metric">
        <option value="weight">Poids</option>
        <option value="volume">Volume</option>
        <option value="reps">RÃ©pÃ©titions</option>
      </select>
      <canvas id="chart" width="400" height="260"></canvas>
    </div>
  </div>
  <div class="card">
    <h3>ðŸ“… Historique</h3>
    <table>
      <thead><tr><th>Date</th><th>SÃ©ance</th><th>Exercice</th><th>Poids</th><th>SÃ©riesÃ—Reps</th><th>Volume</th><th>Notes</th><th></th></tr></thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>
</div>

<script>
// Programme avec cibles (sets, reps)
const PROGRAM={
 "A":[
  {name:"Hip Thrust", target:"4Ã—10â€“12", sets:4, reps:10},
  {name:"Goblet Squat", target:"3Ã—12", sets:3, reps:12},
  {name:"Fentes MarchÃ©es", target:"3Ã—12 / jambe", sets:3, reps:12},
  {name:"DÃ©veloppÃ© CouchÃ©", target:"4Ã—8â€“10", sets:4, reps:8},
  {name:"DÃ©veloppÃ© Militaire", target:"3Ã—10", sets:3, reps:10},
  {name:"Extension Triceps (poulie)", target:"3Ã—12â€“15", sets:3, reps:12},
  {name:"Planche (sec)", target:"3Ã—20â€“30 s", sets:3, reps:20}
 ],
 "B":[
  {name:"Tirage Vertical / Tractions", target:"4Ã—8â€“10", sets:4, reps:8},
  {name:"Rowing HaltÃ¨re", target:"3Ã—12 / bras", sets:3, reps:12},
  {name:"Face Pull", target:"3Ã—15", sets:3, reps:15},
  {name:"Hip Thrust", target:"4Ã—10â€“12", sets:4, reps:10},
  {name:"Leg Extension", target:"3Ã—12â€“15", sets:3, reps:12},
  {name:"Curl Biceps", target:"3Ã—12", sets:3, reps:12},
  {name:"Bird-Dog", target:"3Ã—8 / cÃ´tÃ©", sets:3, reps:8}
 ],
 "C":[
  {name:"DÃ©veloppÃ© InclinÃ©", target:"4Ã—10", sets:4, reps:10},
  {name:"Ã‰lÃ©vations LatÃ©rales", target:"3Ã—12â€“15", sets:3, reps:12},
  {name:"Glute Bridge", target:"3Ã—15", sets:3, reps:15},
  {name:"Leg Curl", target:"3Ã—12", sets:3, reps:12},
  {name:"Presse Ã  Cuisses", target:"3Ã—12", sets:3, reps:12},
  {name:"Curl InclinÃ©", target:"3Ã—12", sets:3, reps:12},
  {name:"Planche LatÃ©rale", target:"3Ã—20â€“30 s / cÃ´tÃ©", sets:3, reps:20},
  {name:"Dead Bug", target:"3Ã—10 / cÃ´tÃ©", sets:3, reps:10}
 ]
};
const KEY="suivi-sessions-v3";
let data=JSON.parse(localStorage.getItem(KEY)||"[]");
const $=id=>document.getElementById(id);
const exoList=$("exoList"),tableBody=$("tableBody"),filter=$("filterExercise"),metric=$("metric"),chart=$("chart").getContext("2d");
$("date").valueAsDate=new Date();

function buildInputs(sessionKey){
  exoList.innerHTML="";
  PROGRAM[sessionKey].forEach(ex=>{
    const row=document.createElement("div");
    row.className="exo-grid";
    row.innerHTML=`
      <div><b>${ex.name}</b> <span class="tag">Cible: ${ex.target}</span></div>
      <div><label>Poids (kg)</label><input data-w type="number" step="0.5" placeholder="0"></div>
      <div><label>SÃ©ries</label><input data-s type="number" value="${ex.sets}"></div>
      <div><label>RÃ©pÃ©titions</label><input data-r type="number" value="${ex.reps}"></div>
      <div><label>Notes</label><input data-n placeholder="RPE, douleur, tempoâ€¦"></div>
      <div><button class="btn" data-add>+ Ajouter</button></div>`;
    row.querySelector("[data-add]").onclick=()=>addEntry(ex.name,sessionKey,row);
    exoList.appendChild(row);
  });
}
function addEntry(name,s,row){
  const e={
    id:crypto.randomUUID(),
    date:$("date").value,
    session:s,
    exercise:name,
    weight:+row.querySelector("[data-w]").value||0,
    sets:+row.querySelector("[data-s]").value||0,
    reps:+row.querySelector("[data-r]").value||0,
    notes:row.querySelector("[data-n]").value||""
  };
  if(e.sets>0&&e.reps>0){data.push(e);save();}else alert("SÃ©ries et reps obligatoires");
}
$("saveSessionBtn").onclick=()=>[...exoList.children].forEach(row=>addEntry(row.querySelector("b").textContent,$("session").value,row));
$("clearBtn").onclick=()=>{if(confirm("Tout supprimer?")){data=[];save();}};
$("exportBtn").onclick=()=>{
  let a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([JSON.stringify(data)],{type:"application/json"}));
  a.download="seances.json";a.click();
};
$("importFile").onchange=e=>{
  let f=e.target.files[0];if(!f)return;
  let r=new FileReader();r.onload=()=>{data=JSON.parse(r.result)||[];save();};r.readAsText(f);
};
$("session").onchange=()=>buildInputs($("session").value);
function save(){localStorage.setItem(KEY,JSON.stringify(data));render();}
function render(){
  $("count").textContent=data.length;
  tableBody.innerHTML="";
  const sel=filter.value||"Tous";
  data.forEach(r=>{
    if(sel!=="Tous"&&r.exercise!==sel)return;
    const vol=r.weight*r.sets*r.reps;
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${r.date}</td><td>${r.session}</td><td>${r.exercise}</td>
      <td>${r.weight}</td><td>${r.sets}Ã—${r.reps}</td><td>${vol}</td><td>${r.notes}</td>
      <td><button onclick="delEntry('${r.id}')">X</button></td>`;
    tableBody.appendChild(tr);
  });
  let exos=["Tous",...new Set(data.map(r=>r.exercise))];
  filter.innerHTML=exos.map(x=>`<option>${x}</option>`).join("");
  draw();
}
function delEntry(id){data=data.filter(r=>r.id!==id);save();}
function draw(){
  const ctx=chart;ctx.clearRect(0,0,400,260);
  const sel=filter.value||"Tous";const m=metric.value;
  const rows=data.filter(r=>sel==="Tous"||r.exercise===sel).sort((a,b)=>a.date.localeCompare(b.date));
  if(!rows.length){ctx.fillStyle="#8b94a7";ctx.fillText("Aucune donnÃ©e",20,130);return;}
  const pts=rows.map((r,i)=>({x:i,y:m==="weight"?r.weight:m==="reps"?r.reps:r.weight*r.sets*r.reps}));
  const max=Math.max(...pts.map(p=>p.y),1);ctx.strokeStyle="#7cc5ff";ctx.beginPath();
  pts.forEach((p,i)=>{let x=30+i*(340/Math.max(1,pts.length-1)),y=220-(p.y/max*180);
    i?ctx.lineTo(x,y):ctx.moveTo(x,y);ctx.arc(x,y,2,0,6.28);ctx.moveTo(x,y);});
  ctx.stroke();
}
buildInputs("A");render();
</script>
</body>
</html>
